version: 2
models:

#### Data Quality
## Final
- name: data_quality__atomic_medical_claim_date_checks
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_date_checks
    tags:
      - data_quality
    materialized: table
  columns:
    - name: test_name
      description: Name of the data quality test
    - name: test_source
      description: Name of the data source the test was completed on
    - name: flagged_records
      description: Number of records (claims) that have not passed the data quality test. 
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.

- name: data_quality__atomic_medical_claim_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_patient_id
    tags:
      - data_quality
    materialized: table
  columns:
    - name: test_name
      description: Name of the data quality test
    - name: test_source
      description: Name of the data source the test was completed on
    - name: flagged_records
      description: Number of records (claims) that have not passed the data quality test. 
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.

- name: data_quality__atomic_primary_keys
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys
    tags:
      - data_quality
    materialized: table
  columns:
    - name: test_name
      description: Name of the data quality test
    - name: test_source
      description: Name of the data source the test was completed on
    - name: flagged_records
      description: Number of records (claims) that have not passed the data quality test. 
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.